# SCNA_comparison
Author: Chiara Schiller

Systematic comparison of spatial cellular neighborhood analysis (SCNA) tools in the course of my master thesis.

## Abstract master thesis
With the advancements in spatial omics technologies, new possibilities for investigating the spatial characteristics of tissues in both health and disease have emerged. The direct spatial relationships between cells provide valuable information about cellular organization and interactions. Retrieving this information from biological data to infer tissue functionality is addressed by a variety of spatial cellular neighborhood analysis (SCNA) methods. The available tools differ in their biological and algorithmic approaches and have thereupon not been systematically compared. In this study, we identified a common algorithmic framework that allows for a modular understanding of SCNA tools for tissue organization analysis. Within this framework, we conducted a systematic comparison of methods based on their ability to differentiate between tissue cohorts. To generate different tissue organization cohorts, we utilized the recent advance in spatial data simulation. After identifying advantageous algorithmic features across SCNA tools, we combined them to create an optimal method, which is now available for use. Our study serves as a comprehensive guide for users and method developers in the field of SCNA while offering a novel approach to evaluate spatial omics tools.

## Summary repo
I systematically compared the SCNA tools Giotto, IMCRtools (classic and histoCAT), MISTy, SEA, i-niche ans SpatialLDA. In this repo, I load the SCNA results of different tissue organization cohorts (repo: IST_generation) and perform binary classification between two cohorts with differing tissue organization parameters. I perfom the classification with a random forest classifier. Further, I evaluate the distinction perfomrance with the F1 score and qualitatively with feature importances. For qualitative conparison, I generate ground-truth tissue organization vectors from the initial simulation of the data.  

![githubrepo_summary_SCNA_comparison (1)](https://github.com/SchapiroLabor/SCNA_comparison/assets/94467188/45cfc2c3-06fd-42a6-966d-3af95f2f55ea)


## Repo structure
notebook: 
- Comparison_SCNA.Rmd: Contains the code for loading all SCNA result files formatted in a sample by interaction feature .csv file 2 folders up to this github repository.
- Comparison_celltype_abundances.Rmd: Perfoms comparison not based on SCNA but on cell type abundance difference between simulated cohorts

SCNA_exploration:
- Comparison_SCNA_preferencediff.Rmd: Compare SCNA results across different cell type abundance groups and not based on different cell-cell adjacencies
- interactionscore_distribution.Rmd: Exploration of the differences between interaction scores of histoCAT and SEA


## How to run this
Please clone this github repository. Input data are. csv files of SCNA results generated by one of the SCNA repos in this githubgroup or by your own analysis. The structure of the SCNA results are samples (rows) by interaction scores (columns). The data folder can be specified at the beginning of the script. 

The naming convention of the samples is crucial for comparison and would need to be adapted for other comparisons.
Our naming of samples was: 

"cross01_0.45_ab0_0.05_13.csv"

Translation: 

"preference_preferencestrength_abundancecelltype_abundance_samplenumber.csv"

The script performs comparison between different prefernces and abundance groups depending on this sample naming convention. 

### Dependencies
`R version 4.2.2 (2022-10-31)`

`Platform: aarch64-apple-darwin20 (64-bit)`

`Running under: macOS Ventura 13.3.1\`

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base  


other attached packages:
 [1] pheatmap_1.0.12       factoextra_1.0.7.999  forcats_1.0.0         stringr_1.5.0         dplyr_1.1.0           purrr_1.0.1           tidyr_1.3.0           tibble_3.1.8          tidyverse_1.3.2      
[10] caret_6.0-94          lattice_0.20-45       randomForestSRC_3.2.1 ggfortify_0.4.16      readr_2.1.3           corrr_0.4.4           ggcorrplot_0.1.4      ggplot2_3.4.0         FactoMineR_2.8 


loaded via a namespace (and not attached):
  [1] googledrive_2.0.0    colorspace_2.1-0     ellipsis_0.3.2       class_7.3-20         estimability_1.4.1   fs_1.6.0             rstudioapi_0.14      farver_2.1.1         listenv_0.9.0       
 [10] bit64_4.0.5          ggrepel_0.9.2        DT_0.27              prodlim_2019.11.13   fansi_1.0.4          mvtnorm_1.1-3        lubridate_1.9.1      xml2_1.3.3           codetools_0.2-18    
 [19] splines_4.2.2        leaps_3.1            knitr_1.42           jsonlite_1.8.4       pROC_1.18.0          broom_1.0.3          cluster_2.1.4        dbplyr_2.3.0         data.tree_1.0.0     
 [28] DiagrammeR_1.0.9     compiler_4.2.2       httr_1.4.4           emmeans_1.8.4-1      backports_1.4.1      assertthat_0.2.1     Matrix_1.5-3         fastmap_1.1.0        gargle_1.3.0        
 [37] cli_3.6.0            visNetwork_2.1.2     htmltools_0.5.4      tools_4.2.2          gtable_0.3.1         glue_1.6.2           reshape2_1.4.4       Rcpp_1.0.10          cellranger_1.1.0    
 [46] vctrs_0.5.2          nlme_3.1-160         iterators_1.0.14     timeDate_4022.108    gower_1.0.1          xfun_0.36            globals_0.16.2       rvest_1.0.3          timechange_0.2.0    
 [55] lifecycle_1.0.3      googlesheets4_1.0.1  future_1.31.0        MASS_7.3-58.1        scales_1.2.1         ipred_0.9-13         vroom_1.6.1          hms_1.1.2            parallel_4.2.2      
 [64] RColorBrewer_1.1-3   yaml_2.3.7           gridExtra_2.3        rpart_4.1.19         stringi_1.7.12       foreach_1.5.2        hardhat_1.2.0        lava_1.7.1           rlang_1.0.6         
 [73] pkgconfig_2.0.3      evaluate_0.20        labeling_0.4.2       recipes_1.0.4        htmlwidgets_1.6.1    bit_4.0.5            tidyselect_1.2.0     parallelly_1.34.0    plyr_1.8.8          
 [82] magrittr_2.0.3       R6_2.5.1             generics_0.1.3       multcompView_0.1-8   DBI_1.1.3            pillar_1.8.1         haven_2.5.1          withr_2.5.0          survival_3.4-0      
 [91] scatterplot3d_0.3-42 nnet_7.3-18          future.apply_1.10.0  crayon_1.5.2         modelr_0.1.10        utf8_1.2.2           tzdb_0.3.0           rmarkdown_2.20       readxl_1.4.1        
[100] grid_4.2.2           data.table_1.14.6    ModelMetrics_1.2.2.2 reprex_2.0.2         digest_0.6.31        flashClust_1.01-2    xtable_1.8-4         stats4_4.2.2         munsell_0.5.0`


